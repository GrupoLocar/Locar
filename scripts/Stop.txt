INICIAR O SERVIÇO:
-----------------
cd C:\Locar\scripts
.\locarsystem.ps1



Passo a passo

1) Primeiro liste para conferir:

Get-CimInstance Win32_Process |
  Where-Object {
    ($_.Name -in @('node.exe','npm.exe')) -and
    ($_.CommandLine -match 'C:\\Locar\\(backend|frontend)')
  } |
  Select-Object ProcessId, Name, CommandLine

Se os PIDs listados forem realmente do Locar, rode o Stop-Process acima.


2) Matar os processos

Get-CimInstance Win32_Process |
  Where-Object {
    ($_.Name -in @('node.exe','npm.exe')) -and
    ($_.CommandLine -match 'C:\\Locar\\(backend|frontend)')
  } |
  ForEach-Object { Stop-Process -Id $_.ProcessId -Force }



Encerrar somente os processos iniciados pelo locarsystem.ps1 (backend e frontend), usando um filtro pela pasta C:\Locar



*** LISTAR TODOSOS PROCESSOS QUE TRAVAM A PASTA
Set-ExecutionPolicy Bypass -Scope Process -Force
C:\temp\Stop-Locar-And-Rename.DryRun.ps1


*** MATAR TODOSOS PROCESSOS QUE TRAVAM A PASTA
cd C:\Locar\scripts\
Set-ExecutionPolicy Bypass -Scope Process -Force
C:\Locar\scripts\Stop-Locar-And-Rename.ps1













existe uma tarefa agendada chamada Start_Ponto com a seguinte configuração:

Windows PowerShell transcript start
Start time: 20250815111344
Username: WORKGROUP\SYSTEM
RunAs User: WORKGROUP\SYSTEM
Configuration Name: 
Machine: WIN-MA5P3VBPTH1 (Microsoft Windows NT 10.0.17763.0)
Host Application: powershell.exe -ExecutionPolicy Bypass -NoProfile -File C:\controle-ponto\Start_Ponto.ps1
Process ID: 1232
PSVersion: 5.1.17763.7553
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.17763.7553
BuildVersion: 10.0.17763.7553
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1

faça um script para modificar a tarefa Start_Ponto executando o script a partir de C:\controle-ponto\script\Start_Ponto.ps1

utilize o script locarsystem.ps1 como parâmetro para rodar somente os comandos abaixo a partir do powershell como um serviço na inicialização do computador com privilégios elevados, faça com que o script permita executar manualmente no powershell além de ser executado automaticamente na inicialização do computador:

cd C:\controle-ponto
node .\server.js





